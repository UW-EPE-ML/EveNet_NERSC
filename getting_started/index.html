<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Getting Started - EveNet Documentation Portal</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Getting Started";
        var mkdocs_page_input_path = "getting_started.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script>
   
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> EveNet Documentation Portal
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Getting Started</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-choose-your-setup-path">1. Choose Your Setup Path</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#option-a-quick-start-docker-pypi">Option A ‚Äî Quick Start (Docker + PyPI)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#option-b-advanced-source-checkout">Option B ‚Äî Advanced (Source Checkout)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-understand-the-project-layout-advanced-users">2. Understand the Project Layout (Advanced Users)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-verify-your-environment">3. Verify Your Environment</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-download-pretrained-weights">4. Download Pretrained Weights</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-prepare-input-data">5. Prepare Input Data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#6-configure-an-experiment">6. Configure an Experiment</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#7-fine-tune-the-model">7. Fine-Tune the Model</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#8-generate-predictions">8. Generate Predictions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#9-explore-and-iterate">9. Explore and Iterate</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data_preparation/">Data Preparation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../model_architecture/">Model Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../train/">Training</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../preprocess_internal_only/">Internal Notes</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">EveNet Documentation Portal</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/UW-EPE-ML/EveNet_Public/edit/master/docs/getting_started.md">Edit on EveNet_Public</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="evenet-tutorial-from-zero-to-first-predictions">üìò EveNet Tutorial: From Zero to First Predictions<a class="headerlink" href="#evenet-tutorial-from-zero-to-first-predictions" title="Permanent link">&para;</a></h1>
<p>New to EveNet? This tutorial walks you through the end-to-end workflow so you can move from a clean checkout to model predictions with confidence. Each step links to a deeper reference guide if you need more detail.</p>
<hr />
<h2 id="1-choose-your-setup-path">1. Choose Your Setup Path<a class="headerlink" href="#1-choose-your-setup-path" title="Permanent link">&para;</a></h2>
<h3 id="option-a-quick-start-docker-pypi">Option A ‚Äî Quick Start (Docker + PyPI)<a class="headerlink" href="#option-a-quick-start-docker-pypi" title="Permanent link">&para;</a></h3>
<p>Ideal when you want the official binaries and ready-made CLIs without touching the source code.</p>
<ol>
<li>Pull the runtime image that bundles CUDA, PyTorch, Ray, and common utilities.
   <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>docker.io/avencast1994/evenet:1.5
docker<span class="w"> </span>run<span class="w"> </span>--gpus<span class="w"> </span>all<span class="w"> </span>-it<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/path/to/your/data:/workspace/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>docker.io/avencast1994/evenet:1.5
</code></pre></div></li>
<li>Inside the container (or any GPU-ready Python 3.12+ environment), install EveNet from PyPI.
   <div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>evenet
</code></pre></div></li>
<li>Invoke the packaged CLIs with your configuration files.
   <div class="highlight"><pre><span></span><code>evenet-train<span class="w"> </span>share/finetune-example.yaml<span class="w"> </span>--ray_dir<span class="w"> </span>~/ray_results
evenet-predict<span class="w"> </span>share/predict-example.yaml
</code></pre></div></li>
</ol>
<p>This path is ‚Äúplug and play‚Äù‚Äîyou only manage YAML configs and data paths.</p>
<h3 id="option-b-advanced-source-checkout">Option B ‚Äî Advanced (Source Checkout)<a class="headerlink" href="#option-b-advanced-source-checkout" title="Permanent link">&para;</a></h3>
<p>Choose this when you want to edit the Lightning modules, extend datasets, or customize the CLI behavior.</p>
<ol>
<li>Clone the repository (or mount it inside the Docker image from Option A).
   <div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/UW-ePE-ML/EveNet_Public.git
<span class="nb">cd</span><span class="w"> </span>EveNet_Public
</code></pre></div></li>
<li>Reuse the provided Docker image <strong>or</strong> create your own environment on Python 3.12+.</li>
<li>Docker: bind mount your checkout and data into the container so code changes persist.</li>
<li>Native install: <code>pip install -r requirements.txt</code> (plus any CUDA/PyTorch builds required by your system).</li>
<li>Run the CLIs straight from source when iterating rapidly.
   <div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>evenet.train<span class="w"> </span>share/finetune-example.yaml<span class="w"> </span>--ray_dir<span class="w"> </span>~/ray_results
python<span class="w"> </span>-m<span class="w"> </span>evenet.predict<span class="w"> </span>share/predict-example.yaml

<span class="c1"># or call the scripts directly</span>
python<span class="w"> </span>evenet/train.py<span class="w"> </span>share/finetune-example.yaml<span class="w"> </span>--ray_dir<span class="w"> </span>~/ray_results
python<span class="w"> </span>evenet/predict.py<span class="w"> </span>share/predict-example.yaml
</code></pre></div></li>
</ol>
<p>Both options are interoperable‚Äîyou can install the PyPI package for quick tests and then switch to the cloned source for deeper development.</p>
<hr />
<h2 id="2-understand-the-project-layout-advanced-users">2. Understand the Project Layout (Advanced Users)<a class="headerlink" href="#2-understand-the-project-layout-advanced-users" title="Permanent link">&para;</a></h2>
<p>Before running any commands, skim these key directories:</p>
<ul>
<li><code>evenet/</code> ‚Äì PyTorch Lightning modules, Ray data pipelines, and trainer utilities.</li>
<li><code>share/</code> ‚Äì Ready-to-edit YAML configurations for fine-tuning and prediction.</li>
<li><code>docs/</code> ‚Äì Reference documentation that expands on this tutorial. Start with <a href="../model_architecture/">Model Architecture Tour</a> to see how point-cloud and global features flow through EveNet.</li>
<li><code>downstreams/</code> ‚Äì Example downstream analysis scripts built on top of EveNet outputs.</li>
</ul>
<hr />
<h2 id="3-verify-your-environment">3. Verify Your Environment<a class="headerlink" href="#3-verify-your-environment" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Review cluster helpers as needed.</strong> The <code>Docker/</code> and <code>NERSC/</code> directories include recipes and SLURM launch scripts tailored for HPC environments.</li>
<li><strong>Confirm GPU visibility (if available).</strong>
   <div class="highlight"><pre><span></span><code>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import torch; print(torch.cuda.device_count())&quot;</span>
</code></pre></div></li>
</ol>
<hr />
<h2 id="4-download-pretrained-weights">4. Download Pretrained Weights<a class="headerlink" href="#4-download-pretrained-weights" title="Permanent link">&para;</a></h2>
<p>EveNet is released as a pretrained foundation model. Start from these weights when fine-tuning or making predictions.</p>
<ul>
<li>
<p>Browse and download weights directly from HuggingFace:<br />
  üëâ <a href="https://huggingface.co/Avencast/EveNet/tree/main">Avencast/EveNet on HuggingFace</a></p>
</li>
<li>
<p>Place the downloaded <code>.ckpt</code> file somewhere accessible and update your YAML configs with the path (see below).</p>
</li>
</ul>
<h2 id="5-prepare-input-data">5. Prepare Input Data<a class="headerlink" href="#5-prepare-input-data" title="Permanent link">&para;</a></h2>
<p>Do not run the scripts under <code>preprocessing/</code>, which are only for large-scale pretraining. For fine-tuning, prepare your own dataset in the EveNet format.</p>
<p>You are responsible for converting your physics ntuples into the EveNet parquet + metadata format.<br />
See <a href="../data_preparation/">data preparation guide</a> for details on schema, normalization, and writer options.  </p>
<blockquote>
<p>üîç Tip: Keep your preprocessing configs in version control so you can reproduce and document each dataset.</p>
</blockquote>
<h2 id="6-configure-an-experiment">6. Configure an Experiment<a class="headerlink" href="#6-configure-an-experiment" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Note:</strong> The example configs are <strong>not standalone</strong>. Each one uses<br />
<code>default: ...yaml</code> to load additional base configs. The parser resolves<br />
these paths relative to the example‚Äôs location, so you must also copy<br />
the referenced YAML files and preserve their directory structure.</p>
</blockquote>
<ol>
<li>
<p>Copy both <code>share/finetune-example.yaml</code> (for training) and <code>share/predict-example.yaml</code> (for inference) into your working directory.  </p>
</li>
<li>
<p>Update key fields for your experiment:</p>
</li>
<li><code>platform.data_parquet_dir</code> ‚Üí directory of your processed parquet files  </li>
<li><code>Dataset.normalization_file</code> ‚Üí path to the normalization statistics you created  </li>
<li><code>options.Training.pretrain_model_load_path</code> ‚Üí pretrained checkpoint to load  </li>
<li>
<p><code>logger</code> ‚Üí project name, WANDB API key, or local log directory  </p>
</li>
<li>
<p>For a detailed description of every section and all available overrides, see the <a href="../configuration/">configuration reference</a>.</p>
</li>
</ol>
<h2 id="7-fine-tune-the-model">7. Fine-Tune the Model<a class="headerlink" href="#7-fine-tune-the-model" title="Permanent link">&para;</a></h2>
<ol>
<li>Export your Weights &amp; Biases API key if you plan to log online.
   <div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WANDB_API_KEY</span><span class="o">=</span>&lt;your_key&gt;
</code></pre></div></li>
<li>Launch training with your updated YAML.</li>
<li><strong>Quick start users:</strong> run the packaged CLI after <code>pip install evenet</code>.
     <div class="highlight"><pre><span></span><code>evenet-train<span class="w"> </span>path/to/your-train-config.yaml
</code></pre></div></li>
<li><strong>Source checkout:</strong> execute the module directly to pick up local code edits.
     <div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>evenet.train<span class="w"> </span>path/to/your-train-config.yaml
</code></pre></div></li>
<li>Monitor progress:</li>
<li>Console output provides per-epoch metrics and checkpoint locations.</li>
<li>WANDB dashboards (if enabled) visualize loss curves and system stats.</li>
<li>Checkpoints and logs are stored under <code>options.Training.model_checkpoint_save_path</code>.</li>
</ol>
<h2 id="8-generate-predictions">8. Generate Predictions<a class="headerlink" href="#8-generate-predictions" title="Permanent link">&para;</a></h2>
<ol>
<li>Ensure the prediction YAML points to your trained (or pretrained) checkpoint via <code>options.Training.model_checkpoint_load_path</code>.</li>
<li>Launch inference with either interface.
   <div class="highlight"><pre><span></span><code><span class="c1"># PyPI package</span>
evenet-predict<span class="w"> </span>path/to/your-predict-config.yaml

<span class="c1"># Source checkout</span>
python<span class="w"> </span>-m<span class="w"> </span>evenet.predict<span class="w"> </span>path/to/your-predict-config.yaml
</code></pre></div></li>
<li>Outputs land in the configured writers (e.g., parquet, numpy archives). See <code>docs/predict.md</code> for writer options and schema notes.</li>
</ol>
<h2 id="9-explore-and-iterate">9. Explore and Iterate<a class="headerlink" href="#9-explore-and-iterate" title="Permanent link">&para;</a></h2>
<ul>
<li>Use the artifacts written in the prediction step for downstream analysis (examples live under <code>downstreams/</code>).</li>
<li>Adjust YAML hyperparameters, architecture templates, or preprocessing selections and repeat the workflow.</li>
<li>When adding new datasets or modules, contribute documentation updates so the next user can follow your path.</li>
</ul>
<p>Happy exploring! üöÄ</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data_preparation/" class="btn btn-neutral float-right" title="Data Preparation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/UW-EPE-ML/EveNet_Public" class="fa fa-code-fork" style="color: #fcfcfc"> EveNet_Public</a>
        </span>
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data_preparation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
